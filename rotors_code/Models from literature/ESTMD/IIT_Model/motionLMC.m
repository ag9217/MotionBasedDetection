function LMC_Output=motionLMC(PR_Output, XDim,YDim)
      H = [-1/9,-1/9, -1/9; -1/9, 8/9, -1/9; -1/9,-1/9, -1/9];
%    H = [-3/9,-3/9, -3/9; -3/9, 24/9, -3/9; -3/9,-3/9, -3/9];
%     H = [-2/25,-2/25, -2/25, -2/25, -2/25;
%         -2/25,-1/25, -1/25, -1/25, -2/25;
%         -2/25, -1/25, 40/25, -1/25, -2/25;
%         -2/25,-1/25, -1/25, -1/25, -2/25;
%         -2/25,-2/25, -2/25, -2/25, -2/25];
%     H = [-3/49,-3/49, -3/49, -3/49, -3/49, -3/49, -3/49;
%         -3/49,-2/49,-2/49, -2/49, -2/49, -2/49, -3/49;
%         -3/49,-2/49,-1/49, -1/49, -1/49, -2/49, -3/49;
%         -3/49,-2/49, -1/49, 112/49, -1/49, -2/49, -3/49;
%         -3/49,-2/49,-1/49, -1/49, -1/49, -2/49, -3/49;
%         -3/49,-2/49,-2/49, -2/49, -2/49, -2/49, -3/49;
%         -3/49,-3/49, -3/49, -3/49, -3/49, -3/49, -3/49];
    G1 = ones(YDim+2, XDim+2);                                                 
    G1(2:(end-1), 2:(end-1)) = PR_Output;
    G1(1, 2:(end-1)) = G1(2, 2:(end-1));        
    G1(end, 2:(end-1)) = G1((end-1), 2:(end-1));
    G1(:, 1) = G1(:, 2);
    G1(:, end) = G1(:, end-1);

    G2 = conv2(G1, H, 'same');           %convolution with gaussian filter kernel
    LMC_Output = G2(2:(end-1), 2:(end-1));
    LMC_Output(:,5:(end)) = G2(2:(end-1), 2:(end-5));
end